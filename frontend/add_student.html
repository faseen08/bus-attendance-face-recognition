<!DOCTYPE html>
<html>
<head>
  <title>Add Student</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-900 text-white p-10">

  <h1 class="text-2xl mb-6">Add Student</h1>

<form id="studentForm" class="space-y-4 max-w-sm">
  <input name="student_id" placeholder="Student ID (Roll No)" class="w-full p-2 rounded bg-slate-800" required />
  <input name="name" placeholder="Full Name" class="w-full p-2 rounded bg-slate-800" required />
  <input name="bus_stop" placeholder="Bus Stop Name" class="w-full p-2 rounded bg-slate-800" required />
  
  <input type="file" name="photo" accept="image/*" class="w-full" required />
  
  <button class="bg-blue-600 hover:bg-blue-500 px-4 py-2 rounded w-full font-bold" type="submit">
    Register Student
  </button>
</form>

  <p id="msg" class="mt-4"></p>

  <!-- Include API utility module -->
  <script src="api.js"></script>

  <script>
    /**
     * Add Student Form Handler
     * 
     * This handles adding a new student profile
     * Uses FormData to send both text data and image file
     * Includes authentication token automatically via apiCall()
     */
    document.getElementById("studentForm").onsubmit = async (e) => {
      e.preventDefault();
      const form = new FormData(e.target);
      const msg = document.getElementById("msg");
      
      try {
        // Make authenticated API call to add student
        // Note: apiCall() handles the token automatically
        const response = await apiCall('/students', {
          method: "POST",
          body: form // FormData is sent as-is
        });

        if (response && response.ok) {
          msg.textContent = "✅ Student added successfully";
          msg.className = "mt-4 text-green-400";
          e.target.reset();
        } else {
          msg.textContent = "❌ Failed to add student";
          msg.className = "mt-4 text-red-400";
        }
      } catch (error) {
        console.error("Error adding student:", error);
        msg.textContent = "❌ Error: Failed to connect to server";
        msg.className = "mt-4 text-red-400";
      }
    };
  </script>

</body>
</html>

